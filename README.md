这部分代码是根据流程图改写的，涉及到部分奇异地方在代码中表明了。